{"version":3,"sources":["Sidebar.tsx"],"names":["react_1","require","react_bootstrap_1","react_collapsible_1","mathjs_1","stats_module_1","Constant","react_csv_1","xml_writer_1","d3","headers","label","key","Sidebar","_super","props","_this","call","this","state","nodeData","edgeData","nodeCount","edgeCount","laplacian","sparse","adjacencyMatrix","e","jsonFormat","runBenchmark","FPSData","handleSubmit","bind","readFiles","generateRandomGraph","generatePair","generateRandomData","refresh","runTest","testFunc","sleep","storeFPSResult","d3TimingStudy","__extends","prototype","event","preventDefault","setNodeEdgeData","time","Promise","resolve","setTimeout","layoutCanvas","select","append","attr","width","height","node","layoutDiv","document","getElementById","style","color","context","getContext","fillStyle","transform","zoomIdentity","json","then","data","console","log","simulation","forceSimulation","nodes","force","forceManyBody","strength","forceCenter","forceLink","edges","distance","simulationUpdate","save","clearRect","translate","x","y","scale","k","forEach","d","beginPath","moveTo","source","lineTo","target","stroke","i","arc","Math","PI","col","fill","restore","on","edgeCounts","nodeCounts","map","n","stats","showPanel","dom","setAttribute","body","appendChild","setState","renderingCanvas","querySelectorAll","length","nCount","toString","eCount","_a","sent","min","max","randRange","floor","random","stepCount","Array","pair","edgeHashMap","Map","has","set","nodeLength","edgeLength","fps","__spreadArrays","refreshing","begin","end","requestId","requestAnimationFrame","TIME_FOR_EACH_TEST","FPS_Array","getFPSHistory","FPS","reduce","a","b","cancelAnimationFrame","files","nodeIDToValue","nodeIDToIndex","degreeMatrix","edgeReader","FileReader","onload","_i","edgeRaw_1","result","split","parts","push","subtract","layoutReader","layoutData_1","parseFloat","j","readAsText","nodeReader","rawNodes_1","element","readJson","jsonReader","graph","JSON","parse","applySpectral","eigs","column","vectors","x_max","y_max","x_min","y_min","get","onSaveXML","xw","startDocument","startElement","writeAttribute","endElement","endDocument","createElement","file","Blob","type","href","URL","createObjectURL","download","click","render","className","Button","onClick","margin","CSVLink","Form","onSubmit","Group","controlId","Check","defaultChecked","Label","Control","multiple","onChange","variant","value","trigger","defaultValue","setWidthFactor","step","setPeakValue","setValleyValue","setGlobalRange","Row","setColorValley","setColorHill","setColorMountain","toggleTerrainLayer","toggleNodeLayer","toggleEdgeLayer","setIdealLength","setCoolingFactor","onSave","runForceDirected","Component","exports"],"mappings":"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","file":"Sidebar.min.js","sourcesContent":["import React from 'react';\r\nimport {Form, Button} from \"react-bootstrap\";\r\nimport Collapsible from 'react-collapsible';\r\nimport { Matrix, matrix, subtract, eigs, column, min, max, index, sparse } from 'mathjs';\r\nimport Stats from \"../libs/stats.module\";\r\nimport * as Constant from \"../constant\";\r\nimport { CSVLink } from \"react-csv\";\r\nimport XMLWriter from \"xml-writer\";\r\nimport * as d3 from \"d3\";\r\n\r\nconst headers = [\r\n  { label: \"Node\", key: \"Node\" },\r\n  { label: \"Edge\", key: \"Edge\" },\r\n  { label: \"FPS\", key: \"FPS\" },\r\n];\r\n\r\n\r\ntype SidebarProps = {\r\n  setNodeEdgeData: (nodeData: Array<number>, edgeData: Array<number>) => void;\r\n  setWidthFactor: (widthFactor: number) => void;\r\n  setPeakValue: (value: number) => void;\r\n  setValleyValue: (value: number) => void;\r\n  setCoolingFactor: (value: number) => void;\r\n  setIdealLength: (value: number) => void;\r\n  setColorValley: (value: number) => void;\r\n  setColorHill: (value: number) => void;\r\n  setColorMountain: (value: number) => void;\r\n  setGlobalRange: () => void;\r\n  toggleNodeLayer: () => void;\r\n  toggleTerrainLayer: () => void;\r\n  toggleEdgeLayer: () => void;\r\n  runForceDirected: () => void;\r\n  onSave: () => void;\r\n};\r\ntype SidebarState = {\r\n  nodeData: Array<number>;\r\n  edgeData: Array<number>;\r\n  laplacian: Matrix;\r\n  adjacencyMatrix: Array<Array<number>>;\r\n  e: {};\r\n  nodeCount: string;\r\n  edgeCount: string;\r\n  runBenchmark: boolean;\r\n  jsonFormat: boolean;\r\n  FPSData: Array<Array<string>>;\r\n  // canvasAdded: boolean;\r\n};\r\ntype edge = {\r\n  id: string;\r\n  source: number;\r\n  target: number;\r\n};\r\ntype node = {\r\n  name: string;\r\n  x: number;\r\n  y: number;\r\n};\r\n\r\ntype nodeD3 = {\r\n  id: string;\r\n  x: number;\r\n  y: number;\r\n};\r\n\r\ntype Graph = {\r\n  nodes: Array<node>;\r\n  edges: Array<edge>;\r\n};\r\nclass Sidebar extends React.Component<SidebarProps, SidebarState> {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      nodeData: [],\r\n      edgeData: [],\r\n      nodeCount: \"\",\r\n      edgeCount: \"\",\r\n      laplacian: sparse([]),\r\n      adjacencyMatrix: [],\r\n      e: {},\r\n      jsonFormat: true,\r\n      runBenchmark: false,\r\n      FPSData: [],\r\n      // canvasAdded: false,\r\n    };\r\n\r\n    this.handleSubmit = this.handleSubmit.bind(this);\r\n    this.readFiles = this.readFiles.bind(this);\r\n    this.generateRandomGraph = this.generateRandomGraph.bind(this);\r\n    this.generatePair = this.generatePair.bind(this);\r\n    this.generateRandomData = this.generateRandomData.bind(this);\r\n    this.refresh = this.refresh.bind(this);\r\n    this.runTest = this.runTest.bind(this);\r\n    this.runBenchmark = this.runBenchmark.bind(this);\r\n    this.testFunc = this.testFunc.bind(this);\r\n    this.sleep = this.sleep.bind(this);\r\n    this.storeFPSResult = this.storeFPSResult.bind(this);\r\n\r\n    // =========================================================\r\n    this.d3TimingStudy = this.d3TimingStudy.bind(this);\r\n    // this.randomDataGen_Computation = this.randomDataGen_Computation.bind(this);\r\n  }\r\n\r\n  handleSubmit(event) {\r\n    event.preventDefault();\r\n    this.props.setNodeEdgeData(this.state.nodeData, this.state.edgeData);\r\n  }\r\n\r\n  sleep(time) {\r\n    return new Promise((resolve) => {\r\n      setTimeout(resolve, time);\r\n    });\r\n  }\r\n\r\n  // randomDataGen_Computation(nodeCount, edgeCount, width, height) {\r\n  //   var nodesWebGPU: Array<number> = [];\r\n  //   var edgesWebGPU: Array<number> = [];\r\n\r\n  //   var nodesD3: Array<nodeD3> = [];\r\n  //   var edgesD3: Array<edge> = [];\r\n\r\n  //   const dataWebGPU = {\r\n  //     nodes: nodesWebGPU,\r\n  //     edges: edgesWebGPU,\r\n  //   };\r\n\r\n  //   const dataD3 = {\r\n  //     nodes: nodesD3,\r\n  //     edges: edgesD3,\r\n  //   };\r\n\r\n  //   dataWebGPU.nodes = new Array(4 * nodeCount).fill(0);\r\n  //   dataWebGPU.edges = new Array(2 * edgeCount).fill(0);\r\n\r\n  //   for (let i = 0; i < nodeCount; i++) {\r\n  //     let x = Math.random();\r\n  //     let y = Math.random();\r\n  //     dataD3.nodes[i] = { id: i.toString(), x: x * width, y: y * height };\r\n  //     dataWebGPU.nodes[4 * i] = 0;\r\n  //     dataWebGPU.nodes[4 * i + 1] = x;\r\n  //     dataWebGPU.nodes[4 * i + 2] = y;\r\n  //     dataWebGPU.nodes[4 * i + 3] = 1;\r\n  //   }\r\n\r\n  //   const linkSet = new Set();\r\n\r\n  //   for (let i = 0; i < edgeCount; i++) {\r\n  //     let pair;\r\n  //     do {\r\n  //       pair = this.generatePair(0, nodeCount);\r\n  //     } while (linkSet.has(`${pair.source}_${pair.target}`));\r\n  //     linkSet.add(`${pair.source}_${pair.target}`);\r\n  //     linkSet.add(`${pair.target}_${pair.source}`);\r\n\r\n  //     dataD3.edges[i] = {\r\n  //       id: i.toString(),\r\n  //       source: pair.source,\r\n  //       target: pair.target,\r\n  //     };\r\n  //     dataWebGPU.edges[2 * i] = pair.source;\r\n  //     dataWebGPU.edges[2 * i + 1] = pair.target;\r\n  //   }\r\n  //   let dataCombined = {\r\n  //     dataD3,\r\n  //     dataWebGPU,\r\n  //   };\r\n  //   return dataCombined;\r\n  // }\r\n\r\n  async d3TimingStudy(event: React.MouseEvent) {\r\n    event.preventDefault();\r\n    const width = 800;\r\n    const height = 800;\r\n\r\n    var layoutCanvas = d3\r\n      .select(\"#graphDiv\")\r\n      .append(\"canvas\")\r\n      .attr(\"width\", width + \"px\")\r\n      .attr(\"height\", height + \"px\")\r\n      .node();\r\n\r\n    let layoutDiv = document.getElementById(\"#graphDiv\");\r\n    if (layoutDiv) {\r\n      layoutDiv.style.color = \"white\";\r\n    }\r\n    // .call(d3.behavior.zoom().on(\"zoom\", simulationUpdate))\r\n\r\n    // this.setState({ canvasAdded: true });\r\n    let context = layoutCanvas!.getContext(\"2d\")!;\r\n\r\n    if (!context) {\r\n      console.log(\"no 2d context found\");\r\n      return;\r\n    }\r\n    context.fillStyle = \"white\";\r\n\r\n    var transform = d3.zoomIdentity;\r\n\r\n    d3.json(\"./test_small_spec.json\").then((data: any) => {\r\n      // const nodes = data.nodes.map((d) => {\r\n      //   d.x = d.x;\r\n      //   d.y = d.y;\r\n      //   d.vx = (d.vx * width) / 10;\r\n      //   d.vy = (d.vy * height) / 10;\r\n      //   return Object.create(d);\r\n      // });\r\n      // console.log(nodes);\r\n\r\n      // data.nodes = nodes;\r\n\r\n      // const edges = data.edges.map((d) => {\r\n      //   return Object.create(d);\r\n      // });\r\n\r\n      // data.edges = edges;\r\n\r\n      console.log(data);\r\n\r\n      const simulation = d3\r\n        .forceSimulation(data.nodes)\r\n        .force(\"charge\", d3.forceManyBody().strength(-40))\r\n        .force(\"center\", d3.forceCenter())\r\n        .force(\"link\", d3.forceLink(data.edges).distance(1).strength(0.1));\r\n\r\n      initGraph(data);\r\n\r\n      function initGraph(data) {\r\n        console.log(data.edges);\r\n        simulation.on(\"tick\", simulationUpdate);\r\n      }\r\n\r\n      function simulationUpdate() {\r\n        context.save();\r\n        context.clearRect(0, 0, width, height);\r\n        context.translate(transform.x, transform.y);\r\n        context.scale(transform.k, transform.k);\r\n\r\n        data.edges.forEach(function (d) {\r\n          context.beginPath();\r\n          context.moveTo(d.source.x, d.source.y);\r\n          context.lineTo(d.target.x, d.target.y);\r\n          context.stroke();\r\n        });\r\n\r\n        // Draw the nodes\r\n        data.nodes.forEach(function (d, i) {\r\n          context.beginPath();\r\n          context.arc(d.x, d.y, 2, 0, 2 * Math.PI, true);\r\n          context.fillStyle = d.col ? \"red\" : \"black\";\r\n          context.fill();\r\n        });\r\n\r\n        context.restore();\r\n      }\r\n    });\r\n  }\r\n\r\n  async runBenchmark(event: React.MouseEvent) {\r\n    event.preventDefault();\r\n    const nodeCounts = [1e6];\r\n    const density = 20;\r\n    const edgeCounts = nodeCounts.map((n) => n * density);\r\n    let stats = Stats();\r\n    stats.showPanel(0);\r\n    stats.dom.setAttribute(\"class\", \"status\");\r\n    document.body.appendChild(stats.dom);\r\n    this.setState({ runBenchmark: true });\r\n    let renderingCanvas = document.querySelectorAll(\"canvas\")[0];\r\n    renderingCanvas.width = 500;\r\n    renderingCanvas.height = 500;\r\n    renderingCanvas.style.width = \"500px\";\r\n    renderingCanvas.style.height = \"500px\";\r\n    // const testCase = {\r\n    //   nodeCounts,\r\n    //   edgeCounts,\r\n    // };\r\n\r\n    for (let i = 0; i < nodeCounts.length - 1; i++) {\r\n      // let stepCount = 0;\r\n      const nCount = nodeCounts[i].toString();\r\n      const eCount = edgeCounts[i].toString();\r\n\r\n      this.setState({ nodeCount: nCount });\r\n      this.setState({ edgeCount: eCount });\r\n\r\n      let data = this.generateRandomData(nodeCounts, edgeCounts, i);\r\n      this.setState({ nodeData: data.nodes });\r\n      this.setState({ edgeData: data.edges });\r\n      // this.props.setNodeEdgeData(this.state.nodeData, this.state.edgeData);\r\n      await this.testFunc(data, stats);\r\n    }\r\n\r\n    this.setState({ runBenchmark: false });\r\n    renderingCanvas.width = 800;\r\n    renderingCanvas.height = 800;\r\n    renderingCanvas.style.width = \"800px\";\r\n    renderingCanvas.style.height = \"800px\";\r\n  }\r\n\r\n  generatePair(min, max) {\r\n    function randRange(min, max) {\r\n      return min + Math.floor(Math.random() * (max - min));\r\n    }\r\n    const source = randRange(min, max);\r\n    let target = randRange(min, max);\r\n    while (source === target) {\r\n      target = randRange(min, max);\r\n    }\r\n    return {\r\n      source: source,\r\n      target: target,\r\n    };\r\n  }\r\n\r\n  generateRandomData(nodeCounts, edgeCounts, stepCount) {\r\n    let nodeCount = nodeCounts[stepCount];\r\n    let edgeCount = edgeCounts[stepCount];\r\n\r\n    let generatedData = this.generateRandomGraph(nodeCount, edgeCount);\r\n    return generatedData;\r\n  }\r\n\r\n  generateRandomGraph(nodeCount, edgeCount) {\r\n    var nodes: Array<number> = [];\r\n    var edges: Array<number> = [];\r\n    const data = {\r\n      nodes: nodes,\r\n      edges: edges,\r\n    };\r\n\r\n    data.nodes = Array(4 * nodeCount).fill(0);\r\n\r\n    for (let i = 0; i < 4 * nodeCount; i = i + 4) {\r\n      data.nodes[i] = 0;\r\n      data.nodes[i + 1] = Math.random();\r\n      data.nodes[i + 2] = Math.random();\r\n      data.nodes[i + 3] = 1;\r\n    }\r\n    const edgeHashMap = new Map();\r\n\r\n    data.edges = Array(2 * edgeCount).fill(0);\r\n    let pair;\r\n\r\n    for (let i = 0; i < 2 * edgeCount; i = i + 2) {\r\n      do {\r\n        pair = this.generatePair(0, nodeCount);\r\n      } while (edgeHashMap.has(`${pair.source}_${pair.target}`));\r\n      edgeHashMap.set(`${pair.source}_${pair.target}`, true);\r\n      edgeHashMap.set(`${pair.target}_${pair.source}`, true);\r\n      data.edges[i] = pair.source;\r\n      data.edges[i + 1] = pair.target;\r\n    }\r\n    return data;\r\n  }\r\n\r\n  refresh(length) {\r\n    var nodes: Array<number> = [];\r\n    for (let i = 0; i < 4 * length; i = i + 4) {\r\n      nodes[i + 1] = Math.random();\r\n      nodes[i + 2] = Math.random();\r\n    }\r\n    this.setState({ nodeData: nodes });\r\n    this.props.setNodeEdgeData(nodes, this.state.edgeData);\r\n  }\r\n\r\n  storeFPSResult(nodeLength, edgeLength, fps) {\r\n    nodeLength = nodeLength.toString();\r\n    edgeLength = edgeLength.toString();\r\n    fps = fps.toString();\r\n\r\n    this.setState({\r\n      FPSData: [...this.state.FPSData, [nodeLength, edgeLength, fps]],\r\n    });\r\n  }\r\n\r\n  async testFunc(data, stats) {\r\n    let nodeLength = data.nodes.length / 4;\r\n    let edgeLength = data.edges.length / 2;\r\n    await this.runTest(nodeLength, edgeLength, stats);\r\n  }\r\n\r\n  async runTest(nodeLength, edgeLength, stats) {\r\n    let requestId;\r\n    const refreshing = () => {\r\n      stats.begin();\r\n      this.refresh(nodeLength);\r\n      stats.end();\r\n      requestId = requestAnimationFrame(refreshing);\r\n    };\r\n    refreshing();\r\n    await this.sleep(Constant.TIME_FOR_EACH_TEST);\r\n    let FPS_Array = stats.getFPSHistory();\r\n    let FPS = FPS_Array.reduce((a, b) => a + b, 0) / FPS_Array.length;\r\n    this.storeFPSResult(nodeLength, edgeLength, FPS);\r\n    cancelAnimationFrame(requestId);\r\n    return;\r\n  }\r\n  readFiles(event: React.ChangeEvent<HTMLInputElement>) {\r\n    const files: FileList = event.target.files!;\r\n    console.log(files);\r\n    var nodeIDToValue = {};\r\n    // var nodeIDToPos = {};\r\n    var nodeIDToIndex = {};\r\n    var nodeData: Array<number> = [];\r\n    var edgeData: Array<number> = [];\r\n    var degreeMatrix: Array<Array<number>> = [];\r\n    var adjacencyMatrix: Array<Array<number>> = [];\r\n    const edgeReader = new FileReader();\r\n    edgeReader.onload = (event) => {\r\n      var edgeRaw = (edgeReader.result as string).split(\"\\n\");\r\n      for (var element of edgeRaw) {\r\n        var parts = element.split(\"\\t\");\r\n        if (nodeIDToValue[parts[0]] && nodeIDToValue[parts[1]]) {\r\n          edgeData.push(nodeIDToIndex[parts[0]], nodeIDToIndex[parts[1]]);\r\n          degreeMatrix[nodeIDToIndex[parts[0]]][nodeIDToIndex[parts[0]]] += 1;\r\n          degreeMatrix[nodeIDToIndex[parts[1]]][nodeIDToIndex[parts[1]]] += 1;\r\n          adjacencyMatrix[nodeIDToIndex[parts[0]]][\r\n            nodeIDToIndex[parts[1]]\r\n          ] += 1;\r\n          adjacencyMatrix[nodeIDToIndex[parts[1]]][\r\n            nodeIDToIndex[parts[0]]\r\n          ] += 1;\r\n        }\r\n      }\r\n      this.setState({ edgeData: edgeData });\r\n      var laplacian: Matrix = subtract(\r\n        sparse(degreeMatrix),\r\n        sparse(adjacencyMatrix)\r\n      ) as Matrix;\r\n      console.log(laplacian);\r\n      this.setState({ laplacian: laplacian, adjacencyMatrix: adjacencyMatrix });\r\n    };\r\n    const layoutReader = new FileReader();\r\n    layoutReader.onload = (event) => {\r\n      var layoutData = (layoutReader.result as string).split(\"\\n\");\r\n      for (var element of layoutData) {\r\n        var parts = element.split(\"\\t\");\r\n        if (nodeIDToValue[parts[0]]) {\r\n          nodeIDToIndex[parts[0]] = nodeData.length / 4;\r\n          // Pushes values to node data in order of struct for WebGPU:\r\n          // nodeValue, nodeX, nodeY, nodeSize\r\n          nodeData.push(\r\n            parseFloat(nodeIDToValue[parts[0]]),\r\n            parseFloat(parts[1]),\r\n            parseFloat(parts[2]),\r\n            parseFloat(parts[3])\r\n          );\r\n          // nodeIDToPos[parts[0]] = [parseFloat(parts[1]) * 2.0 - 1, parseFloat(parts[2]) * 2.0 - 1];\r\n        }\r\n      }\r\n      this.setState({ nodeData: nodeData });\r\n      for (var i = 0; i < nodeData.length / 4; i++) {\r\n        degreeMatrix.push([]);\r\n        adjacencyMatrix.push([]);\r\n        for (var j = 0; j < nodeData.length / 4; j++) {\r\n          degreeMatrix[i].push(0);\r\n          adjacencyMatrix[i].push(0);\r\n        }\r\n      }\r\n      edgeReader.readAsText(files[2]);\r\n    };\r\n    const nodeReader = new FileReader();\r\n    nodeReader.onload = (event) => {\r\n      var rawNodes = (nodeReader.result as string).split(\"\\n\");\r\n      for (var element of rawNodes) {\r\n        nodeIDToValue[element.split(\"\\t\")[0]] = element.split(\"\\t\")[1];\r\n      }\r\n      console.log(nodeIDToValue);\r\n      layoutReader.readAsText(files[1]);\r\n    };\r\n    nodeReader.readAsText(files[0]);\r\n  }\r\n\r\n  readJson(event: React.ChangeEvent<HTMLInputElement>) {\r\n    const files: FileList = event.target.files!;\r\n    const jsonReader = new FileReader();\r\n    var nodeData: Array<number> = [];\r\n    var edgeData: Array<number> = [];\r\n    jsonReader.onload = (event) => {\r\n      var graph: Graph = JSON.parse(jsonReader.result as string);\r\n      console.log(graph);\r\n      for (var i = 0; i < graph.nodes.length; i++) {\r\n        if (graph.nodes[i].x) {\r\n          nodeData.push(0.0, graph.nodes[i].x, graph.nodes[i].y, 1.0);\r\n        } else {\r\n          nodeData.push(0.0, Math.random(), Math.random(), 1.0);\r\n        }\r\n      }\r\n      for (var i = 0; i < graph.edges.length; i++) {\r\n        var source = graph.edges[i].source;\r\n        var target = graph.edges[i].target;\r\n        edgeData.push(source, target);\r\n      }\r\n      this.setState({ nodeData: nodeData, edgeData: edgeData });\r\n    };\r\n    jsonReader.readAsText(files[0]);\r\n  }\r\n\r\n  applySpectral() {\r\n    var e = eigs(this.state.laplacian);\r\n    console.log(e);\r\n    var nodeData = this.state.nodeData;\r\n    var x = column(e.vectors, 1) as Matrix;\r\n    var y = column(e.vectors, 2) as Matrix;\r\n    var x_max = max(x);\r\n    var y_max = max(y);\r\n    var x_min = min(x);\r\n    var y_min = min(y);\r\n    for (var i = 0; i < nodeData.length / 4; i++) {\r\n      nodeData[i * 4 + 1] = (x.get([i, 0]) - x_min) / (x_max - x_min);\r\n      nodeData[i * 4 + 2] = (y.get([i, 0]) - y_min) / (y_max - y_min);\r\n    }\r\n    this.setState({ nodeData: nodeData });\r\n    this.props.setNodeEdgeData(nodeData, this.state.edgeData);\r\n  }\r\n\r\n  onSaveXML() {\r\n    var xw = new XMLWriter(true);\r\n    xw.startDocument();\r\n    xw.startElement(\"GeneTerrain\");\r\n    xw.startElement(\"Nodes\");\r\n    for (var i = 0; i < this.state.nodeData.length; i += 4) {\r\n      xw.startElement(\"Node\");\r\n      xw.writeAttribute(\"NodeID\", i / 4);\r\n      xw.writeAttribute(\"InputValue\", this.state.nodeData[i]);\r\n      xw.writeAttribute(\"InputWeight\", this.state.nodeData[i + 3]);\r\n      xw.writeAttribute(\"NodeBackendX\", this.state.nodeData[i + 1]);\r\n      xw.writeAttribute(\"NodeBackendY\", this.state.nodeData[i + 2]);\r\n      xw.endElement(\"Node\");\r\n    }\r\n    xw.endElement(\"Nodes\");\r\n    xw.startElement(\"Edges\");\r\n    for (var i = 0; i < this.state.edgeData.length; i += 2) {\r\n      xw.startElement(\"Edge\");\r\n      xw.writeAttribute(\"BeginID\", this.state.edgeData[i]);\r\n      xw.writeAttribute(\"EndID\", this.state.edgeData[i + 1]);\r\n      xw.endElement(\"Edge\");\r\n    }\r\n    xw.endElement(\"Edges\");\r\n    xw.endDocument();\r\n    const element = document.createElement(\"a\");\r\n    const file = new Blob([xw.toString()], { type: \"application/xml\" });\r\n    element.href = URL.createObjectURL(file);\r\n    element.download = \"terrain.xml\";\r\n    document.body.appendChild(element); // Required for this to work in FireFox\r\n    element.click();\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"sidebar\">\r\n        <hr />\r\n        <Button className=\"benchmark_test\" onClick={this.runBenchmark}>\r\n          Run Benchmark\r\n        </Button>\r\n        <div style={{ margin: 10, color: \"white\" }}>\r\n          <p>Node count: {this.state.nodeCount}</p>\r\n          <p>Edge count: {this.state.edgeCount}</p>\r\n        </div>\r\n        <CSVLink data={this.state.FPSData}>Download FPS data</CSVLink>\r\n        <hr />\r\n\r\n        <Button className=\"d3Timing_test\" onClick={this.d3TimingStudy}>\r\n          Run D3\r\n        </Button>\r\n\r\n        <Form style={{ color: \"white\" }} onSubmit={this.handleSubmit}>\r\n          <Form.Group controlId=\"formFile\" className=\"mt-3 mb-3\">\r\n            <Form.Check\r\n              defaultChecked={true}\r\n              onClick={() =>\r\n                this.setState({ jsonFormat: !this.state.jsonFormat })\r\n              }\r\n              type=\"checkbox\"\r\n              label=\"Json Format\"\r\n            ></Form.Check>\r\n            <Form.Label>Select Example Files</Form.Label>\r\n            <Form.Control\r\n              className=\"form-control\"\r\n              type=\"file\"\r\n              multiple\r\n              onChange={(e) => {\r\n                if (this.state.jsonFormat) {\r\n                  this.readJson(e as React.ChangeEvent<HTMLInputElement>);\r\n                } else {\r\n                  this.readFiles(e as React.ChangeEvent<HTMLInputElement>);\r\n                }\r\n              }}\r\n            />\r\n            <Button\r\n              className=\"mt-2\"\r\n              type=\"submit\"\r\n              variant=\"secondary\"\r\n              value=\"Submit\"\r\n            >\r\n              Submit\r\n            </Button>\r\n          </Form.Group>\r\n          <Collapsible trigger=\"Terrain Options\">\r\n            <Form.Group>\r\n              <Form.Label> Width Factor </Form.Label>\r\n              <br />\r\n              <input\r\n                type=\"range\"\r\n                defaultValue={1000}\r\n                min={0}\r\n                max={2000}\r\n                onChange={(e) =>\r\n                  this.props.setWidthFactor(parseFloat(e.target.value))\r\n                }\r\n              />\r\n            </Form.Group>\r\n            <Form.Group>\r\n              <Form.Label> Peak and Valley Values </Form.Label>\r\n              <br />\r\n              <input\r\n                type=\"range\"\r\n                defaultValue={0.8}\r\n                min={0.5}\r\n                max={1}\r\n                step={0.01}\r\n                onChange={(e) =>\r\n                  this.props.setPeakValue(parseFloat(e.target.value))\r\n                }\r\n              />\r\n              <input\r\n                type=\"range\"\r\n                defaultValue={0.2}\r\n                min={0}\r\n                max={0.5}\r\n                step={0.01}\r\n                onChange={(e) =>\r\n                  this.props.setValleyValue(parseFloat(e.target.value))\r\n                }\r\n              />\r\n            </Form.Group>\r\n            <Form.Group>\r\n              <Form.Check\r\n                defaultChecked={true}\r\n                onClick={(e) => this.props.setGlobalRange()}\r\n                type=\"checkbox\"\r\n                label=\"Use Global Min/Max\"\r\n              ></Form.Check>\r\n            </Form.Group>\r\n          </Collapsible>\r\n          <Collapsible trigger=\"Colormap Options\">\r\n            <Form.Row>\r\n              <div>Valley</div>\r\n              <input\r\n                type=\"range\"\r\n                defaultValue={45}\r\n                min={1}\r\n                max={60}\r\n                step={1}\r\n                onChange={(e) =>\r\n                  this.props.setColorValley(parseFloat(e.target.value))\r\n                }\r\n              />\r\n            </Form.Row>\r\n            <Form.Row>\r\n              <div>Hill</div>\r\n              <input\r\n                type=\"range\"\r\n                defaultValue={90}\r\n                min={61}\r\n                max={120}\r\n                step={1}\r\n                onChange={(e) =>\r\n                  this.props.setColorHill(parseFloat(e.target.value))\r\n                }\r\n              />\r\n            </Form.Row>\r\n            <Form.Row>\r\n              <div>Mountain</div>\r\n              <input\r\n                type=\"range\"\r\n                defaultValue={135}\r\n                min={121}\r\n                max={180}\r\n                step={1}\r\n                onChange={(e) =>\r\n                  this.props.setColorMountain(parseFloat(e.target.value))\r\n                }\r\n              />\r\n            </Form.Row>\r\n          </Collapsible>\r\n          <Collapsible trigger=\"Layers\">\r\n            <Form.Check\r\n              defaultChecked={false}\r\n              onClick={(e) => this.props.toggleTerrainLayer()}\r\n              type=\"checkbox\"\r\n              label=\"Terrain Layer\"\r\n            />\r\n            <Form.Check\r\n              defaultChecked={true}\r\n              onClick={(e) => this.props.toggleNodeLayer()}\r\n              type=\"checkbox\"\r\n              label=\"Node Layer\"\r\n            />\r\n            <Form.Check\r\n              defaultChecked={true}\r\n              onClick={(e) => this.props.toggleEdgeLayer()}\r\n              type=\"checkbox\"\r\n              label=\"Edge Layer\"\r\n            />\r\n          </Collapsible>\r\n          <Collapsible trigger=\"Force Directed Options\">\r\n            <Form.Label> Ideal Length and Cooling Factor </Form.Label>\r\n            <br />\r\n            <input\r\n              type=\"range\"\r\n              defaultValue={0.05}\r\n              min={0.001}\r\n              max={0.1}\r\n              step={0.001}\r\n              onChange={(e) =>\r\n                this.props.setIdealLength(parseFloat(e.target.value))\r\n              }\r\n            />\r\n            <input\r\n              type=\"range\"\r\n              defaultValue={0.9}\r\n              min={0.75}\r\n              max={0.999}\r\n              step={0.001}\r\n              onChange={(e) =>\r\n                this.props.setCoolingFactor(parseFloat(e.target.value))\r\n              }\r\n            />\r\n          </Collapsible>\r\n          <Button onClick={(e) => this.props.onSave()}>Save Terrain</Button>\r\n          <br />\r\n          <Button onClick={(e) => this.applySpectral()}>\r\n            Apply Spectral Layout\r\n          </Button>\r\n          <br />\r\n          <Button onClick={(e) => this.props.runForceDirected()}>\r\n            Run Force Directed Layout\r\n          </Button>\r\n          <br />\r\n          <Button onClick={(e) => this.onSaveXML()}>Save Terrain to XML</Button>\r\n        </Form>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Sidebar;"]}