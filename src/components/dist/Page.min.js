"use strict";var __extends=this&&this.__extends||function(){var a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};return function(e,t){function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),__awaiter=this&&this.__awaiter||function(e,i,s,l){return new(s=s||Promise)(function(t,r){function a(e){try{o(l.next(e))}catch(e){r(e)}}function n(e){try{o(l.throw(e))}catch(e){r(e)}}function o(e){e.done?t(e.value):function(t){return t instanceof s?t:new s(function(e){e(t)})}(e.value).then(a,n)}o((l=l.apply(e,i||[])).next())})},__generator=this&&this.__generator||function(r,a){var n,o,i,e,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,o&&(i=2&t[0]?o.return:t[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,t[1])).done)return i;switch(o=0,i&&(t=[2&t[0],i.value]),t[0]){case 0:case 1:i=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,o=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(i=0<(i=s.trys).length&&i[i.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!i||t[1]>i[0]&&t[1]<i[3])){s.label=t[1];break}if(6===t[0]&&s.label<i[1]){s.label=i[1],i=t;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(t);break}i[2]&&s.ops.pop(),s.trys.pop();continue}t=a.call(r,s)}catch(e){t=[6,e],o=0}finally{n=i=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};exports.__esModule=!0;var react_1=require("react"),Sidebar_1=require("./Sidebar"),react_2=require("react"),render_1=require("../webgpu/render"),rainbow_png_1=require("./rainbow.png"),rainbow2_png_1=require("./rainbow2.png"),react_bootstrap_1=require("react-bootstrap"),react_select_1=require("react-select");function importAll(r){var a={};return r.keys().map(function(e,t){a[e.replace("./","").replace(".png","")]=r(e)}),a}var colormaps=importAll(require.context("../colormaps",!1,/\.(png|jpe?g|svg)$/)),colormap_list=["magma","inferno","plasma","viridis","cividis","twilight","twilight_shifted","turbo","Blues","BrBG","BuGn","BuPu","CMRmap","GnBu","Greens","Greys","OrRd","Oranges","PRGn","PiYG","PuBu","PuBuGn","PuOr","PuRd","Purples","RdBu","RdGy","RdPu","RdYlBu","RdYlGn","Reds","Spectral","Wistia","YlGn","YlGnBu","YlOrBr","YlOrRd","afmhot","autumn","binary","bone","brg","bwr","cool","coolwarm","copper","cubehelix","flag","gist_earth","gist_gray","gist_heat","gist_ncar","gist_rainbow","gist_stern","gist_yarg","gnuplot","gnuplot2","gray","hot","hsv","jet","nipy_spectral","ocean","pink","prism","rainbow","seismic","spring","summer","terrain","winter","Accent","Dark2","Paired","Pastel1","Pastel2","Set1","Set2","Set3","tab10","tab20","tab20b","tab20c","magma_r","inferno_r","plasma_r","viridis_r","cividis_r","twilight_r","twilight_shifted_r","turbo_r","Blues_r","BrBG_r","BuGn_r","BuPu_r","CMRmap_r","GnBu_r","Greens_r","Greys_r","OrRd_r","Oranges_r","PRGn_r","PiYG_r","PuBu_r","PuBuGn_r","PuOr_r","PuRd_r","Purples_r","RdBu_r","RdGy_r","RdPu_r","RdYlBu_r","RdYlGn_r","Reds_r","Spectral_r","Wistia_r","YlGn_r","YlGnBu_r","YlOrBr_r","YlOrRd_r","afmhot_r","autumn_r","binary_r","bone_r","brg_r","bwr_r","cool_r","coolwarm_r","copper_r","cubehelix_r","flag_r","gist_earth_r","gist_gray_r","gist_heat_r","gist_ncar_r","gist_rainbow_r","gist_stern_r","gist_yarg_r","gnuplot_r","gnuplot2_r","gray_r","hot_r","hsv_r","jet_r","nipy_spectral_r","ocean_r","pink_r","prism_r","rainbow_r","seismic_r","spring_r","summer_r","terrain_r","winter_r","Accent_r","Dark2_r","Paired_r","Pastel1_r","Pastel2_r","Set1_r","Set2_r","Set3_r","tab10_r","tab20_r","tab20b_r","tab20c_r"];console.log(colormaps.magma.default),console.log(rainbow_png_1.default);var Page=function(r){function e(e){var t=r.call(this,e)||this;return t.state={widthFactor:1e3,canvasRef:react_2.createRef(),outCanvasRef:react_2.createRef(),colorCanvasRef:react_2.createRef(),fpsRef:react_2.createRef(),iterRef:react_2.createRef(),colorValley:45,colorHill:90,colorMountain:135,renderer:null},t}return __extends(e,r),e.prototype.componentDidMount=function(){return __awaiter(this,void 0,void 0,function(){var t,r,a,n;return __generator(this,function(e){switch(e.label){case 0:return[4,navigator.gpu.requestAdapter()];case 1:return t=e.sent(),console.log(t),[4,t.requestDevice({requiredLimits:{maxStorageBufferBindingSize:t.limits.maxStorageBufferBindingSize}})];case 2:return r=e.sent(),(a=new Image).src=rainbow_png_1.default,[4,a.decode()];case 3:return e.sent(),[4,createImageBitmap(a)];case 4:return n=e.sent(),this.setState({renderer:new render_1.default(t,r,this.state.canvasRef,n,a,this.state.outCanvasRef,this.state.fpsRef,this.state.iterRef)}),[2]}})})},e.prototype.setNodeEdgeData=function(e,t){this.state.renderer.setNodeEdgeData(e,t)},e.prototype.setWidthFactor=function(e){this.state.renderer.setWidthFactor(e)},e.prototype.setPeakValue=function(e){this.state.renderer.setPeakValue(e)},e.prototype.setValleyValue=function(e){this.state.renderer.setValleyValue(e)},e.prototype.setIdealLength=function(e){this.state.renderer.setIdealLength(e)},e.prototype.setCoolingFactor=function(e){this.state.renderer.setCoolingFactor(e)},e.prototype.setGlobalRange=function(){this.state.renderer.setGlobalRange()},e.prototype.setColorValley=function(e){this.setState({colorValley:e}),this.updateColormap()},e.prototype.setColorHill=function(e){this.setState({colorHill:e}),this.updateColormap()},e.prototype.setColorMountain=function(e){this.setState({colorMountain:e}),this.updateColormap()},e.prototype.toggleNodeLayer=function(){this.state.renderer.toggleNodeLayer()},e.prototype.toggleTerrainLayer=function(){this.state.renderer.toggleTerrainLayer()},e.prototype.toggleEdgeLayer=function(){this.state.renderer.toggleEdgeLayer()},e.prototype.updateColormap=function(){return __awaiter(this,void 0,void 0,function(){var t,r,a,n,o,i,s;return __generator(this,function(e){switch(e.label){case 0:return(t=new Image).src=rainbow2_png_1.default,[4,t.decode()];case 1:for(e.sent(),r=this.state.colorCanvasRef.current,(a=r.getContext("2d")).drawImage(t,0,0),n=a.getImageData(0,0,180,1),o=0;o<this.state.colorValley;o++)n.data[4*o]=0,n.data[4*o+1]=0+255/this.state.colorValley*o,n.data[4*o+2]=255,n.data[4*o+3]=255;for(o=this.state.colorValley;o<this.state.colorHill;o++)n.data[4*o]=0,n.data[4*o+1]=255,n.data[4*o+2]=255-255/(this.state.colorHill-this.state.colorValley)*(o-this.state.colorValley),n.data[4*o+3]=255;for(o=this.state.colorHill;o<this.state.colorMountain;o++)n.data[4*o]=0+255/(this.state.colorMountain-this.state.colorHill)*(o-this.state.colorHill),n.data[4*o+1]=255,n.data[4*o+2]=0,n.data[4*o+3]=255;for(o=this.state.colorMountain;o<180;o++)n.data[4*o]=255,n.data[4*o+1]=255-255/(180-this.state.colorMountain)*(o-this.state.colorMountain),n.data[4*o+2]=0,n.data[4*o+3]=255;return a.putImageData(n,0,0),i=r.toDataURL(),t.src=i,[4,t.decode()];case 2:return e.sent(),[4,createImageBitmap(t)];case 3:return s=e.sent(),this.state.renderer.setColormap(s,t),[2]}})})},e.prototype.changeColormap=function(a){return __awaiter(this,void 0,void 0,function(){var t,r;return __generator(this,function(e){switch(e.label){case 0:return(t=new Image).src=colormaps[a].default,[4,t.decode()];case 1:return e.sent(),[4,createImageBitmap(t)];case 2:return r=e.sent(),this.state.renderer.setColormap(r,t),[2]}})})},e.prototype.runForceDirected=function(){this.state.renderer.runForceDirected()},e.prototype.onSave=function(){this.state.renderer.onSave()},e.prototype.render=function(){var t=this;return react_1.default.createElement("div",{className:"main_wrapper"},react_1.default.createElement(Sidebar_1.default,{setValleyValue:this.setValleyValue.bind(this),setPeakValue:this.setPeakValue.bind(this),setWidthFactor:this.setWidthFactor.bind(this),setNodeEdgeData:this.setNodeEdgeData.bind(this),setGlobalRange:this.setGlobalRange.bind(this),setIdealLength:this.setIdealLength.bind(this),setCoolingFactor:this.setCoolingFactor.bind(this),toggleNodeLayer:this.toggleNodeLayer.bind(this),toggleTerrainLayer:this.toggleTerrainLayer.bind(this),toggleEdgeLayer:this.toggleEdgeLayer.bind(this),runForceDirected:this.runForceDirected.bind(this),setColorHill:this.setColorHill.bind(this),setColorValley:this.setColorValley.bind(this),setColorMountain:this.setColorMountain.bind(this),onSave:this.onSave.bind(this)}),react_1.default.createElement("div",{className:"canvasContainer"},react_1.default.createElement(react_select_1.default,{className:"m-2",placeholder:"Choose colormap...",onChange:function(e){return t.changeColormap(e.value)},options:colormap_list.map(function(e){return{label:e,value:e}})}),react_1.default.createElement(react_bootstrap_1.Form.Label,{className:"out",ref:this.state.fpsRef},"FPS: n/a"),react_1.default.createElement("br",null),react_1.default.createElement(react_bootstrap_1.Form.Label,{className:"out",ref:this.state.iterRef}),react_1.default.createElement("div",{id:"node_count"}),react_1.default.createElement("canvas",{ref:this.state.canvasRef,width:800,height:800}),react_1.default.createElement("canvas",{hidden:!0,ref:this.state.outCanvasRef,width:800,height:800}),react_1.default.createElement("canvas",{hidden:!0,ref:this.state.colorCanvasRef,width:180,height:1})))},e}(react_1.default.Component);exports.default=Page;
//# sourceMappingURL=Page.min.js.map
